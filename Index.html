<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fantasy Lineup Manager</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#0b1220; color:#eaf0ff; margin:0; }
    .container { max-width:1100px; margin:0 auto; padding:24px; }
    .header { display:flex; justify-content:space-between; align-items:center; }
    .title { font-size:24px; font-weight:700; }
    .card { background:#121a2b; border-radius:12px; padding:16px; margin-top:16px; }
    .grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
    .slot { background:#0f192e; border:1px solid #223052; border-radius:10px; padding:12px; }
    select, button { font-size:14px; padding:6px; border-radius:8px; }
    .actions { display:flex; gap:10px; flex-wrap:wrap; }
    .pill { padding:6px 10px; border-radius:999px; background:#0f1e35; border:1px solid #223052; color:#8aa0c8; }
    .teamCard { background:#0f192e; border-radius:12px; padding:12px; }
    .list { max-height:160px; overflow:auto; }
    .error { color:#ff6b6b; }
    .success { color:#70e000; }
  </style>
</head>
<body>
  <div id="root">Loading...</div>

  <script>
    // Paste your full CSV text here between backticks
    const csvText = `
Team 1 - Joe/EJ ,Team 2 - Jumbo/Uly ,Team 3 - Tom/Burdick,Team 4 - Flo/Jeff,Team 5 - Al/Jon,Team 6 - Tony/Brother,Team 7 - Charlie/Rico,Team 8 - Ski/Suk
QB,QB,QB,QB,QB,QB,QB,QB
Dak Prescott,Daniel Jones,Josh Allen,Jared Goff,Baker Mayfield,Pat Mahomes,Joe Flacco,Lamar Jackson
Joe Burrow,Justin Herbert,Bo Nix,C.J. Stroud,Tua Tagovailoa,Jordan Love,Jalen Hurts,Brock Purdy
...
WR,WR,WR,WR,WR,WR,WR,WR
Ja'Marr Chase,Brian Thomas Jr.,Puka Nacua,Romeo Doubs,Calvin Ridley,Amon St. Brown,CeeDee Lamb,Justin Jefferson
Emeka Egbuka,Jameson Williams,Cortland Sutton,Drake London,Mike Evans,Davante Adams,Ladd McConkey,Darius Slayton
...
`; // truncated for brevity — paste full CSV here

    function parseLeagueCSV(text) {
      const rows = text.trim().split("\n").map(r => r.split(","));
      const headers = rows[0].map(h => h.trim());
      const teams = {};
      headers.forEach(h => { if(h) teams[h] = []; });

      let currentPos = "";
      for (let i=1; i<rows.length; i++) {
        const row = rows[i];
        // detect position row (e.g. QB, RB, WR)
        if (row.every(cell => cell && cell.trim().length<=3)) {
          currentPos = row[0].trim();
          continue;
        }
        // otherwise treat as player row
        row.forEach((cell, idx) => {
          const player = cell.trim();
          if (player) {
            const teamName = headers[idx];
            if (teamName) {
              teams[teamName].push({ name: player, pos: currentPos });
            }
          }
        });
      }
      return teams;
    }

    const POSITIONS = ["QB","RB1","RB2","WR1","WR2","FLEX","TE","K","DEF"];
    const FLEX_ELIG = new Set(["RB","WR","TE"]);

    function byPos(players, slot) {
      if (slot==="RB1"||slot==="RB2") return players.filter(p=>p.pos==="RB");
      if (slot==="WR1"||slot==="WR2") return players.filter(p=>p.pos==="WR");
      if (slot==="FLEX") return players.filter(p=>FLEX_ELIG.has(p.pos));
      return players.filter(p=>p.pos===slot);
    }

    function init() {
      const teams = parseLeagueCSV(csvText);
      let manager = Object.keys(teams)[0] || "";
      let lineup = Object.fromEntries(POSITIONS.map(s=>[s,""]));
      let locked = false;
      let message = "";

      function render() {
        const root = document.getElementById("root");
        const allPlayers = Object.entries(teams).flatMap(([m,roster])=>roster.map(p=>({...p,team:m})));
        const managerRoster = teams[manager]||[];

        root.innerHTML = `
          <div class="container">
            <div class="header">
              <div class="title">Fantasy Lineup Manager</div>
              <div class="pill">Manager</div>
              <select id="managerSel">${Object.keys(teams).map(m=>`<option ${m===manager?"selected":""}>${m}</option>`).join("")}</select>
              <span class="pill">${locked?"Locked":"Unlocked"}</span>
            </div>

            <div class="card">
              <div class="actions">
                <button id="submitBtn" ${locked?"disabled":""}>Submit lineup</button>
                <button id="editBtn" ${!locked?"disabled":""}>Edit lineup</button>
                <button id="clearBtn">Clear</button>
              </div>
              ${message?`<div class="${message.includes("error")?"error":"success"}">${message}</div>`:""}
            </div>

            <div class="grid">
              <div class="teamCard">
                <h3>${manager} roster</h3>
                <div class="list">
                  ${managerRoster.map(p=>`<div>${p.name} (${p.pos})</div>`).join("")}
                </div>
              </div>

              <div class="teamCard" style="grid-column:span 2">
                <h3>Set lineup</h3>
                <div class="grid">
                  ${POSITIONS.map(slot=>{
                    const choices = byPos(allPlayers,slot);
                    const selected = lineup[slot];
                    return `
                      <div class="slot">
                        <h4>${slot}</h4>
                        <select data-slot="${slot}" ${locked?"disabled":""}>
                          <option value="">Select ${slot}</option>
                          ${choices.map(p=>`<option value="${p.name}" ${selected===p.name?"selected":""}>${p.name} (${p.pos}) — ${p.team}</option>`).join("")}
                        </select>
                        ${selected?`<div>${selected}</div>`:""}
                      </div>
                    `;
                  }).join("")}
                </div>
              </div>
            </div>
          </div>
        `;

        document.getElementById("managerSel").onchange = e => { manager=e.target.value; lineup=Object.fromEntries(POSITIONS.map(s=>[s,""])); render(); };
        document.querySelectorAll("[data-slot]").forEach(sel=>{
          sel.onchange = e => { lineup[e.target.dataset.slot]=e.target.value; };
        });
        document.getElementById("submitBtn").onclick = ()=>{ locked=true; message="Lineup submitted"; render(); };
        document.getElementById("editBtn").onclick = ()=>{ locked=false; message="Lineup unlocked"; render(); };
